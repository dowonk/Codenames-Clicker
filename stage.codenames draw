(async () => {
  const delay = ms => new Promise(res => setTimeout(res, ms));

  const cards = Array.from(document.querySelectorAll('div[role="img"]'))
    .filter(card => card.hasAttribute('tabindex'))
    .sort((a, b) =>
      parseInt(a.getAttribute('tabindex'), 10) -
      parseInt(b.getAttribute('tabindex'), 10)
    )
    .slice(0, 25);

  let previousTarget = null;
  let lastTarget = null;

  // Step 1: Click all 25 cards sequentially
  for (const card of cards) {
    const target = card.querySelector('.cardImage');
    if (!target) continue;

    target.click();
    console.log(`Clicked tabindex ${card.tabIndex}`);
    await delay(50);

    if (previousTarget) {
      previousTarget.click();
      console.log('Cancelled previous card');
      await delay(50);
    }

    previousTarget = target;
    lastTarget = target;
  }

  // Unclick the 25th card
  if (lastTarget) {
    await delay(50);
    lastTarget.click();
    console.log('Unclicked 25th card');
  }

  console.log('‚úÖ Finished clicking and unclicking all 25 cards');

  /* ============================
     DRAW X ON THE BOARD (NO DELAY)
     ============================ */

  const xTabs = [0, 4, 6, 8, 12, 16, 18, 20, 24];

  const cardsByTab = cards.reduce((map, card) => {
    map[parseInt(card.getAttribute('tabindex'), 10)] = card;
    return map;
  }, {});

  for (const tab of xTabs) {
    const card = cardsByTab[tab];
    if (!card) continue;

    const target = card.querySelector('.cardImage');
    if (!target) continue;

    target.click();
    console.log(`‚ùå X click tabindex ${tab}`);
  }

  console.log('‚ùå X drawn on the board (no delay)');

  // ======= Pause 1 second =======
  await delay(1000);

  // ======= Unclick all X cards =======
  for (const tab of xTabs) {
    const card = cardsByTab[tab];
    if (!card) continue;

    const target = card.querySelector('.cardImage');
    if (!target) continue;

    target.click();
    console.log(`‚¨ú Unclicked X tabindex ${tab}`);
  }

  console.log('‚úÖ X cards unclicked');

  // ======= Pause 1 second =======
  await delay(1000);

  // ======= Click all outer border cards =======
  const borderTabs = [0, 1, 2, 3, 4, 5, 9, 10, 14, 15, 19, 20, 21, 22, 23, 24]; // Outer border of 5x5
  for (const tab of borderTabs) {
    const card = cardsByTab[tab];
    if (!card) continue;

    const target = card.querySelector('.cardImage');
    if (!target) continue;

    target.click();
    console.log(`üî≤ Border click tabindex ${tab}`);
  }

  console.log('‚úÖ Outer border clicked');
})();
