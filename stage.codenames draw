(async () => {
  const delay = ms => new Promise(res => setTimeout(res, ms));

  const cards = Array.from(document.querySelectorAll('div[role="img"]'))
    .filter(card => card.hasAttribute('tabindex'))
    .sort((a, b) =>
      parseInt(a.getAttribute('tabindex'), 10) -
      parseInt(b.getAttribute('tabindex'), 10)
    )
    .slice(0, 25);

  let previousTarget = null;
  let lastTarget = null;

  for (const card of cards) {
    const target = card.querySelector('.cardImage');
    if (!target) continue;

    // Click current card
    target.click();
    console.log(`Clicked tabindex ${card.tabIndex}`);
    await delay(50);

    // Cancel previous card
    if (previousTarget) {
      previousTarget.click();
      console.log('Cancelled previous card');
      await delay(50);
    }

    previousTarget = target;
    lastTarget = target;
  }

  // Unclick the 25th (last) card
  if (lastTarget) {
    await delay(50);
    lastTarget.click();
    console.log('Unclicked 25th card');
  }

  console.log('✅ Finished clicking and unclicking all 25 cards');

  /* ============================
     DRAW X ON THE BOARD (NO DELAY)
     ============================ */

  const xTabs = [0, 4, 6, 8, 12, 16, 18, 20, 24];

  const cardsByTab = cards.reduce((map, card) => {
    map[parseInt(card.getAttribute('tabindex'), 10)] = card;
    return map;
  }, {});

  for (const tab of xTabs) {
    const card = cardsByTab[tab];
    if (!card) continue;

    const target = card.querySelector('.cardImage');
    if (!target) continue;

    target.click();
    console.log(`❌ X click tabindex ${tab}`);
  }

  console.log('❌ X drawn on the board (no delay)');
})();
