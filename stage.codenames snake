(async () => {
  const delay = ms => new Promise(res => setTimeout(res, ms));

  const cards = Array.from(document.querySelectorAll('div[role="img"]'))
    .filter(card => card.hasAttribute('tabindex'))
    .sort((a, b) =>
      parseInt(a.getAttribute('tabindex'), 10) -
      parseInt(b.getAttribute('tabindex'), 10)
    )
    .slice(0, 25);

  let previousTarget = null;
  let lastTarget = null;

  for (const card of cards) {
    const target = card.querySelector('.cardImage');
    if (!target) continue;

    // Click current card
    target.click();
    console.log(`Clicked tabindex ${card.tabIndex}`);
    await delay(50);

    // Cancel previous card
    if (previousTarget) {
      previousTarget.click();
      console.log('Cancelled previous card');
      await delay(50);
    }

    previousTarget = target;
    lastTarget = target;
  }

  // Unclick the 25th (last) card
  if (lastTarget) {
    await delay(50);
    lastTarget.click();
    console.log('Unclicked 25th card');
  }

  console.log('âœ… Finished clicking and unclicking all 25 cards');
})();
